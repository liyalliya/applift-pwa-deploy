(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[888],{1118:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return n(5318)}])},7333:function(e,t,n){"use strict";n.d(t,{E:function(){return u},e:function(){return c}});var a=n(5893),o=n(7294);let l=(0,o.createContext)(null),i=["6e400001-b5a3-f393-e0a9-e50e24dcca9e","0000ffe0-0000-1000-8000-00805f9b34fb","4fafc201-1fb5-459e-8fcc-c5c9c331914b"],r=e=>{if(!e)return!1;let t=e.name||"";return t.trim().length>0&&!t.toLowerCase().includes("unknown")};function c(e){let{children:t}=e,[n,c]=(0,o.useState)(!0),[u,s]=(0,o.useState)(!0),[d,v]=(0,o.useState)(!1),[m,h]=(0,o.useState)(null),[f,g]=(0,o.useState)(!1),[w,b]=(0,o.useState)(null),y=(0,o.useRef)(null),[p,S]=(0,o.useState)(null),[E,P]=(0,o.useState)(!1),[A,D]=(0,o.useState)([]),[I,L]=(0,o.useState)(null);(0,o.useEffect)(()=>{if(!navigator.bluetooth||!navigator.bluetooth.getAvailability)return;let e=!0;navigator.bluetooth.getAvailability().then(t=>{e&&c(!!t)}).catch(()=>c(!1));let t=e=>{var t;c(!!(null!==(t=e.value)&&void 0!==t?t:e.available))};try{navigator.bluetooth.addEventListener("availabilitychanged",t)}catch(e){try{navigator.bluetooth.onavailabilitychanged=t}catch(e){}}return()=>{e=!1;try{navigator.bluetooth.removeEventListener("availabilitychanged",t)}catch(e){}try{navigator.bluetooth.onavailabilitychanged=null}catch(e){}}},[]),(0,o.useEffect)(()=>{if(!navigator.bluetooth||!navigator.bluetooth.getAvailability)return;let e=!0;navigator.bluetooth.getAvailability().then(t=>{e&&c(!!t)}).catch(()=>c(!1));let t=e=>{var t;c(!!(null!==(t=e.value)&&void 0!==t?t:e.available))};try{navigator.bluetooth.addEventListener("availabilitychanged",t)}catch(e){try{navigator.bluetooth.onavailabilitychanged=t}catch(e){}}return()=>{e=!1;try{navigator.bluetooth.removeEventListener("availabilitychanged",t)}catch(e){}try{navigator.bluetooth.onavailabilitychanged=null}catch(e){}}},[]);let C=async()=>{if(!navigator.bluetooth){c(!1);return}if(!n){alert("Bluetooth appears to be off on this device. Please enable Bluetooth and try scanning again.");return}P(!0),D([]),S(null);try{let e=await navigator.bluetooth.requestDevice({filters:[{name:"AppLift_IMU"}],optionalServices:i});e&&r(e)?D(t=>t.some(t=>t.id===e.id)?t:[e,...t]):e&&!r(e)&&S("Device has no name or is unknown. Please select a device with a valid name.")}catch(e){S(e.message),"NotAllowedError"===e.name&&s(!1)}finally{P(!1)}},O=async e=>{var t,n,a,o,l,r;if(e)try{if(S(null),s(!0),v(!0),h(null!==(t=e.id)&&void 0!==t?t:null),e.gatt&&"function"==typeof e.gatt.connect){let t=await e.gatt.connect();if(e.addEventListener("gattserverdisconnected",()=>{g(!1),b(null),y.current=null;try{window.localStorage.removeItem("bleDevice")}catch(e){}}),t&&t.connected){b(e),y.current=e,g(!0);try{let t={id:e.id,name:e.name};window.localStorage.setItem("bleDevice",JSON.stringify(t))}catch(e){}try{let t=null!==(a=null!==(n=e.name)&&void 0!==n?n:e.id)&&void 0!==a?a:"device";L("Paired with ".concat(t)),setTimeout(()=>L(null),4e3)}catch(e){}(async()=>{for(let e of i)try{if(await t.getPrimaryService(e)){console.log("Found BLE service on device:",e);break}}catch(e){}})()}else g(!1)}else{b(e),g(!0);try{let t={id:e.id,name:e.name};window.localStorage.setItem("bleDevice",JSON.stringify(t))}catch(e){}try{let t=null!==(l=null!==(o=e.name)&&void 0!==o?o:e.id)&&void 0!==l?l:"device";L("Paired with ".concat(t)),setTimeout(()=>L(null),4e3)}catch(e){}}}catch(e){S(null!==(r=e.message)&&void 0!==r?r:String(e)),g(!1)}finally{v(!1),h(null)}},_=()=>{let e=y.current||w;if(e)try{e.gatt&&e.gatt.connected&&e.gatt.disconnect()}catch(e){console.error("Disconnect error:",e)}y.current=null,b(null),g(!1),D(t=>t.filter(t=>t.id!==(null==e?void 0:e.id)));try{window.localStorage.removeItem("bleDevice")}catch(e){}};(0,o.useEffect)(()=>{let e=window.localStorage.getItem("bleDevice");if(e&&!f&&!w)try{let t=JSON.parse(e);navigator.bluetooth&&navigator.bluetooth.getDevices&&navigator.bluetooth.getDevices().then(e=>{let n=e.find(e=>e.id===t.id);n?O(n):window.localStorage.removeItem("bleDevice")}).catch(()=>{window.localStorage.removeItem("bleDevice")})}catch(e){window.localStorage.removeItem("bleDevice")}},[]);let M=(0,o.useMemo)(()=>({availability:n,permissionGranted:u,connecting:d,connectingDeviceId:m,connected:f,device:w,devicesFound:A,error:p,scanning:E,pairMessage:I,scanDevices:C,connectToDevice:O,disconnect:_,setPairMessage:L}),[n,u,d,m,f,w,A,p,E,I]);return(0,a.jsx)(l.Provider,{value:M,children:t})}function u(){let e=(0,o.useContext)(l);if(!e)throw Error("useBluetooth must be used within BluetoothProvider");return e}},5318:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return m}});var a=n(5893);n(3434);var o=n(7294),l=n(1163),i=n(6409);let r=()=>window.matchMedia("(display-mode: standalone)").matches||window.matchMedia("(display-mode: fullscreen)").matches||!0===window.navigator.standalone,c=()=>/iPad|iPhone|iPod/.test(navigator.userAgent)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,u=()=>c()&&!0===window.navigator.standalone,s=()=>window.matchMedia("(display-mode: fullscreen)").matches?"fullscreen":window.matchMedia("(display-mode: standalone)").matches?"standalone":window.matchMedia("(display-mode: minimal-ui)").matches?"minimal-ui":"browser",d=()=>{let e={isPWA:r(),isIOS:c(),isIOSPWA:u(),displayMode:s(),isStandalone:window.matchMedia("(display-mode: standalone)").matches,isFullscreen:window.matchMedia("(display-mode: fullscreen)").matches,isIOSStandalone:window.navigator.standalone,safeAreaInsets:{top:getComputedStyle(document.documentElement).getPropertyValue("--safe-area-top"),bottom:getComputedStyle(document.documentElement).getPropertyValue("--safe-area-bottom"),left:getComputedStyle(document.documentElement).getPropertyValue("--safe-area-left"),right:getComputedStyle(document.documentElement).getPropertyValue("--safe-area-right")},userAgent:navigator.userAgent};return console.log("\uD83D\uDE80 PWA Status:",e),e.isIOSPWA?console.log("✅ Running as iOS PWA in standalone mode"):e.isIOS&&console.log("\uD83D\uDCF1 iOS detected - Add to Home Screen for fullscreen"),e};var v=n(7333),m=function(e){let{Component:t,pageProps:n}=e;(0,l.useRouter)();let[c,u]=(0,o.useState)(null),[s,m]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{function e(e){e.preventDefault(),u(e),m(!0),console.log("beforeinstallprompt captured")}function t(){u(null),m(!1),console.log("PWA installed")}return d(),r()&&(m(!1),console.log("✅ Running as installed PWA - install button hidden")),"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js",{scope:"/"}).then(e=>console.log("SW registered with scope:",e.scope)).catch(e=>console.error("SW registration failed:",e)),window.addEventListener("beforeinstallprompt",e),window.addEventListener("appinstalled",t),()=>{window.removeEventListener("beforeinstallprompt",e),window.removeEventListener("appinstalled",t)}},[]),(0,o.useEffect)(()=>{},[]),(0,o.useEffect)(()=>{if(!document.fullscreenElement)return;let e=async()=>{try{document.documentElement.requestFullscreen&&!document.fullscreenElement&&await document.documentElement.requestFullscreen()}catch(e){console.log("Fullscreen request failed (may be normal):",e.message)}},t=()=>{e(),document.removeEventListener("click",t),document.removeEventListener("touchstart",t)};return document.addEventListener("click",t),document.addEventListener("touchstart",t),()=>{document.removeEventListener("click",t),document.removeEventListener("touchstart",t)}},[]),(0,a.jsx)(v.e,{children:(0,a.jsx)(i.X,{children:(0,a.jsx)(t,{...n})})})}},6409:function(e,t,n){"use strict";n.d(t,{G:function(){return u},X:function(){return c}});var a=n(5893),o=n(7294);let l="applift:userProfile",i={userId:null,username:"",email:"",authProvider:"email",termsAccepted:!1,termsAcceptedAt:null,gender:"",birthMonth:"",birthYear:"",age:null,height:null,heightUnit:"ft",heightFeet:"",heightInches:"",heightCm:"",weight:null,fitnessLevel:"",fitnessGoal:"",liftingConfidence:"",createdAt:null,onboardingCompleted:!1},r=(0,o.createContext)(null);function c(e){let{children:t}=e,[n,c]=(0,o.useState)(()=>{try{let e=window.localStorage.getItem(l);return e?{...i,...JSON.parse(e)}:i}catch(e){return console.warn("Failed to read profile storage:",e),i}});(0,o.useEffect)(()=>{try{window.localStorage.setItem(l,JSON.stringify(n))}catch(e){console.warn("Failed to persist profile:",e)}},[n]);let u=e=>{c(t=>({...t,...e}))},s=()=>c(i),d=(0,o.useMemo)(()=>({profile:n,updateProfile:u,resetProfile:s}),[n]);return(0,a.jsx)(r.Provider,{value:d,children:t})}function u(){let e=(0,o.useContext)(r);if(!e)throw Error("useUserProfile must be used within UserProfileProvider");return e}},3434:function(){},1163:function(e,t,n){e.exports=n(3079)}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[774,179],function(){return t(1118),t(3079)}),_N_E=e.O()}]);